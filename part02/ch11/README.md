# API 접근 보안

에지 서버를 통해 공개되는 복합 마이크로서비스, 유레카 API 및 웹 페이지(유레카 서버)에 대한 접근을 보호하기 

## OAuth 2.0 및 OpenID Connect 소개
```
* 용어 정리

인증: 사용자 이름과 암호 같은 사용자가 제공하는 자격 증명을 확인해 사용자를 식별하는 것
권한 부여: 식별된 사용자에게 API 에 대한 접근 권한을 부여 (ex OAuth 2.0 스코프)
OAuth 2.0: 권한 부여를 위한 공개 표준

OpenID Connect: 클라이언트 애플리케이션이 권한 부여 서버에서 받은 자격 증명을 기반으로 사용자의 신원을 확인할 수
있도록 OAuth 2.0 에 추가된 기능
```
### OAuth 2.0 소개
```
OAuth 2.0 는 서드파티 클라이언트 애플리케이션(웹 클라이언트) 가 사용자를 대신해 보안 리소스에 접근할 수 있게 해준다. 
```
```
* 개념 정리

자원 소유자 resource owner: 최종 사용자. (유저)
클라이언트 client: 최종 사용자의 권한을 위임 받아 보안 API 를 호출하는 서브파티 애플리케이션(웹 앱, 네이티브  모바일 앱)
자원 서버 resource server: 보호 대상 자원에 대한 API 를 제공하는 서버 (게이트 웨이 -> 유레카, 복합 마이크로서비스)

권한 부여 서버 authorization server: 자원 소유자를 인증하고 자원 소유자의 승인을 바다서 *클라이언트* 에게 토큰을 발급한다.
사용자 정보 관리 및 사용자 인증은 보통 ID 제공자에게 위임된다.
```
```
* 권한 부여 서버를 사용해서 권한을 부여 받는 전체적인 흐름

사용자 -> 클라이언트(웹 앱) -> API 접근 요청 클라이언트는 리소스에 접근하기 위해 권한 부여 서버에서 권한을 부여받아야 한다.
사용자의 자격 증명을 클라이언트 와 공유하지 않기 위해 권한 부여 서버에서는 클라이언트에 토큰을 발급한다. 

클라이언트는 이 토큰으로 승인된 API 에 접근할 수 있다. 토큰 시간에는 제한이 있고 OAuth 2.0 스코프를 사용해서 접근 권한을 제한한다. 
권한 부여 서버는 클라이언트 애플리케이션에 재발급 토큰을 발급할 수 있다. 

https://github.com/eternalrecurrenceofthesame/Spring-security-in-Action/tree/main/ch16
토큰을 부여받는 각 그랜트 유형은 위 링크를 참고한다.
```













